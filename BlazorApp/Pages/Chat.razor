@page "/Chat"


<AlertBox />

<div class="background-wrapper" id="main">

    <OnlineUsers ChatUsers="this.ChatUsers" />

    <ChatPanel />

</div>

@code{ 

    protected override async Task OnInitializedAsync()
    {
        await ChatService.GetChatUsers();
        ChatService.OnStatesChanged += UpdateState;
    }

    public void UpdateState()
    {
        InvokeAsync(StateHasChanged);
    }

    public void OnConnectedUser(UserEventArgs e)
    {
        UpdateState();
    }

    public void OnDisconnectedUser(UserEventArgs e)
    {
        UpdateState();
    }

    public List<User> ChatUsers
    {
        get
        {
            return ChatService.ChatUsers;
        }
    }

    [Inject]
    IChatService ChatService { get; set; }
}
